<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>InterfaceZ: Return of the Z-iffying</title>
    <link rel="shortcut icon" href="images/favicon.ico" />
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-theme.css" rel="stylesheet">
    <link href="css/sticky-footer-navbar.css" rel="stylesheet">
    <link href="css/structure.css" rel="stylesheet"/>
    <link href="css/detailed.css" rel="stylesheet"/>
    <link href="css/fancy.css" rel="stylesheet"/>
    <script src="js/jquery-2.1.0.js"></script>

</head>
<body ng-app="thesis" ng-controller="MainController">
    <div id="header">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">InterfaceZ</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li ng-repeat="i in interfaceManager.menuOptions" ng-click="$parent.goToMenu(i)" ng-class="{active:i==interfaceManager.menuActive}">
                            <a href="#">{{i}}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <div class="container-fluid">
        <div id="leftbar">
            <div class="spacing">
                <div class="boxed fitsFileSelector" dropzone>
                    <h3 class="centered" style="margin: 0;" ng-show="!fits.properties[0]">{{getDropText()}}</h3>
                    <div class="info" ng-show="fits.properties[0]">
                        <h4 class="centered"  style="margin: 0;">{{fits.properties[0].value}}</h4>
                        <ul class="list-unstyled">
                            <li ng-repeat="i in fits.properties | onlyDisplay"><b class="label">{{i.label}}:</b> {{i.displayValue}}</li>
                        </ul>
                    </div>
                </div>
                <div class="boxed lined spectralList">
                    <ul class="list-unstyled">
                        <li ng-class-even="'even'" ng-repeat="i in spectraManager.getAll() track by i.id" ng-dblclick="$parent.goToDetailed()" ng-click="$parent.setSpectraIndex(i.index)" ng-class="{activeSelect:interfaceManager.spectraIndex==i.index}" class="spectraSmall">
                            <p><b>{{i.id}}</b></p>
                            <div class="info" id="spectra{{i.id}}">
                                <p ng-show="i.finalZ==null">Not analysed</p>
                                <p ng-show="i.finalZ!=null">{{i.getFinalTemplateID()}},  z={{i.getFinalRedshift().toFixed(4)}},      QOP: {{i.getQOP().toFixed(0)}}</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="rightbar" ng-class="{nonzero:(interfaceManager.menuActive=='Overview' || interfaceManager.menuActive=='Detailed')}">
            <div ng-class="{spacing:(interfaceManager.menuActive=='Overview' || interfaceManager.menuActive=='Detailed')}">
                <div class="dataselector" ng-show="interfaceManager.menuActive=='Overview' || interfaceManager.menuActive=='Detailed'">
                    <b>Data Selection:</b>
                    <button type="button" class='btn btn-warning' ng-click="toggleDisp('raw')">Raw</button>
                    <button type="button" class='btn btn-success' ng-click="toggleDisp('pro')">Processed</button>
                    <button type="button" class='btn btn-danger'  ng-click="toggleDisp('templ')">Template</button>
                    <button type="button" class='btn btn-info'  ng-click="toggleDisp('sky')">Sky</button>
                </div>
                <div class="topspace" ng-if="interfaceManager.menuActive=='Overview'">
                    <b>Display Data As:</b>
                    <div class="btn-group">
                        <button type="button" class="btn btn-default" ng-click="interfaceManager.overviewGraph=true" ng-class="{active:(interfaceManager.overviewGraph==true)}">Graph</button>
                        <button type="button" class="btn btn-default" ng-click="interfaceManager.overviewGraph=false" ng-class="{active:(interfaceManager.overviewGraph==false)}">Table</button>
                    </div>
                </div>
                <div class="topspace" ng-if="interfaceManager.menuActive=='Detailed'">
                    <label>Template:</label>
                    <select style="width: 235px" ng-change="$parent.changedTemplate()" ng-model="$parent.interfaceManager.detailedViewTemplate" data-ng-options="t.index as t.id + ' - ' + t.name for t in $parent.templateManager.getTemplatesAsJson()"></select>

                    <label>Scale: </label>
                    <input style="width: 55px" type="text" ng-change="$parent.interfaceManager.detailedSettings.updateTemplateScale()" ng-model="$parent.interfaceManager.detailedSettings.templateScale">
                    <input style="width: 170px" type="range" min="{{$parent.interfaceManager.detailedSettings.minScale}}" max="{{$parent.interfaceManager.detailedSettings.maxScale}}"  step="0.01" ng-change="$parent.interfaceManager.detailedSettings.setTemplateScale()" ng-model="$parent.interfaceManager.detailedSettings.templateScale">

                    <label>Redshift: </label>
                    <input style="width: 55px" type="text" ng-change="$parent.changedTemplate()" ng-model="$parent.interfaceManager.detailedViewZ">
                    <input style="width: 170px" type="range" min={{$parent.interfaceManager.getMinRedshiftForDetailedTemplate()}} max="{{$parent.interfaceManager.detailedViewZMax}}" step="0.0001" ng-change="$parent.interfaceManager.detailedUpdateRequired=true" ng-model="$parent.interfaceManager.detailedViewZ">
                    <div class="clear"></div>
                </div>
                <div class="topspace" ng-if="interfaceManager.menuActive=='Detailed'">
                    <b>Data Filtering</b>
                    <label style="width: 130px">Raw Smooth:</label>
                    <input style="width: 30px" type="text" ng-change="$parent.interfaceManager.changeRawSmooth()" ng-model="$parent.interfaceManager.detailViewRawSmooth">
                    <input style="width: 135px" type="range" min="0" max="{{$parent.interfaceManager.detailViewSmoothMax}}"  step="1" ng-change="$parent.interfaceManager.changeRawSmooth()" ng-model="$parent.interfaceManager.detailViewRawSmooth">
                    <label style="width: 130px">Processed Smooth:</label>
                    <input style="width: 30px" type="text" ng-change="$parent.interfaceManager.changeProcessedSmooth()" ng-model="$parent.interfaceManager.detailViewProcessedSmooth">
                    <input style="width: 135px" type="range" min="0" max="{{$parent.interfaceManager.detailViewSmoothMax}}"  step="1" ng-change="$parent.interfaceManager.changeProcessedSmooth()" ng-model="$parent.interfaceManager.detailViewProcessedSmooth">
                </div>
                <div class="topspace" ng-if="interfaceManager.menuActive=='Detailed'">
                    <b>Save this redshift with a QOP of:</b>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-danger" ng-click="$parent.interfaceManager.saveManual(1)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Illegible (1)</button>
                        <button class="btn btn-sm btn-warning" ng-click="$parent.interfaceManager.saveManual(2)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Poor (2)</button>
                        <button class="btn btn-sm btn-info" ng-click="$parent.interfaceManager.saveManual(3)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Good (3)</button>
                        <button class="btn btn-sm btn-success" ng-click="$parent.interfaceManager.saveManual(4)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Great (4)</button>
                    </div>
                </div>
                <div class="topspace" ng-if="interfaceManager.menuActive=='Detailed'">
                    <b>Spectral Lines</b>
                    <ul class="list-unstyled" ng-class="{glowing:interfaceManager.detailedSettings.getWaiting()}">
                        <li class="sline lined"  ng-click="$parent.interfaceManager.clickSpectralLine(i.id)" ng-class="{enabled:i.enabled}" ng-repeat="i in spectalLines.getAll() track by i.id">
                                {{i.label}}
                        </li>
                    </ul>
                    <button class="btn btn-primary"  style="display: block; width: 200px; margin: 0 auto;" ng-click="$parent.interfaceManager.detailedSettings.toggleSpectralLines()">{{getSpectralLinePhrase()}}</button>
                </div>
            </div>
        </div>
        <div id="central">
            <div class="spacing">
                <ng-include src="'views/centralOverview.html'" ng-show="interfaceManager.menuActive=='Overview'"></ng-include>
                <div class="templateList" ng-show="interfaceManager.menuActive=='Templates'">
                    <ul class="list-unstyled">
                        <li class="overviewItem lined overviewLarge" ng-repeat="t in templateManager.getAll() track by t.id">
                            <div class="topbar"><b>Template ID: {{t.id}}</b><p>{{t.name}},  &Aring;: {{t.start_lambda_linear.toFixed(1)}} &rarr; {{t.end_lambda_linear.toFixed(1)}}</p></div>
                            <div class="graph"><canvas id="smallTemplateCanvas{{$index}}" style="width:100%; height:100%;"></canvas>{{interfaceManager.renderTemplate($index)}}</div>
                        </li>
                    </ul>
                </div>
                <div class="detailedView" ng-show="interfaceManager.menuActive=='Detailed'">
                    <div id="big" style="z-index: 999;"><canvas id="detailedCanvas" style="height: 100%; width: 100%"></canvas></div>
                    {{interfaceManager.renderDetailedInitial()}}
                </div>
                <ng-include src="'views/usage.html'" ng-if="interfaceManager.menuActive=='Usage'"></ng-include>
            </div>
        </div>
    </div>
    <div id="footer" class="navbar-inverse">
        <div class="container-fluid">
            <div ng-if="interfaceManager.waitingDrop()">
                <p>Please drop in a FITs file.</p>
            </div>
            <div ng-if="!interfaceManager.waitingDrop()">
                <div ng-if="interfaceManager.analysing()">
                    <div class="floatleft" ng-if="!interfaceManager.finishedAnalysis()">
                        <p>Analysing spectra. Please wait.   {{interfaceManager.getNumAnalysed()}}/{{interfaceManager.getNumSpectra()}}</p>
                    </div>
                    <div class="floatleft" ng-if="interfaceManager.finishedAnalysis()">
                        <p>Analysis finished. {{interfaceManager.getNumAnalysed()}}/{{interfaceManager.getNumSpectra()}}</p>
                    </div>
                </div>
                <div ng-if="!interfaceManager.analysing()">
                    <div class="floatleft" ng-if="!interfaceManager.finishedProcessing()">
                        <p>Processing spectra. Please wait.   {{interfaceManager.getNumProcessed()}}/{{interfaceManager.getNumSpectra()}}</p>
                    </div>
                </div>
                <div class="floatright" style="margin-top: -8px;">
                    <button class="btn btn-small btn-info" ng-click="processorManager.toggleActiveProcessing()">{{interfaceManager.getPausedText()}}</button>
                    <button class="btn btn-small btn-primary" ng-click="downloadResults()">Download</button>
                </div>
                <div class="fillrest">
                    <progressbar animate="false" ng-if="interfaceManager.analysing()" class="progress-striped active" max="interfaceManager.getNumSpectra()" value="interfaceManager.getNumAnalysed()" type="{{interfaceManager.getProgressBarType()}}"></progressbar>
                    <progressbar animate="false" ng-if="!interfaceManager.analysing()" class="progress-striped active" max="interfaceManager.getNumSpectra()" value="interfaceManager.getNumProcessed()" type="{{interfaceManager.getProgressBarType()}}"></progressbar>
                </div>
            </div>
        </div>
    </div>
    <script src="js/bootstrap.js"></script>
    <script src="js/angular.js"></script>
    <script src="js/angular-animate.js"></script>
    <script src="js/angular-drop.js"></script>
    <script src="js/ui-bootstrap-tpls-0.10.0.js"></script>
    <script src="js/fits.js"></script>
    <script src="js/ResultLoader.js"></script>
    <script src="js/FileSaver.js"></script>
    <script src="js/regression.js"></script>
    <script src="js/tools.js"></script>
    <script src="js/spectralLines.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/views.js"></script>
    <script src="js/classes.js"></script>
    <script src="js/app.js"></script>
</body>
</html>