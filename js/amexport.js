AmCharts.AmExport=AmCharts.Class({construct:function(h,b){var c=this;c.DEBUG=!1;c.chart=h;c.canvas=null;c.svgs=[];c.cfg={menuTop:"auto",menuLeft:"auto",menuRight:"0px",menuBottom:"0px",menuItems:[{textAlign:"center",icon:c.chart.pathToImages+"export.png",iconTitle:"Save chart as an image",format:"png"}],menuItemStyle:{backgroundColor:"transparent",rollOverBackgroundColor:"#EFEFEF",color:"#000000",rollOverColor:"#CC0000",paddingTop:"6px",paddingRight:"6px",paddingBottom:"6px",paddingLeft:"6px",marginTop:"0px",
marginRight:"0px",marginBottom:"0px",marginLeft:"0px",textAlign:"left",textDecoration:"none",fontFamily:c.chart.fontFamily,fontSize:c.chart.fontSize+"px"},menuItemOutput:{backgroundColor:"#FFFFFF",fileName:"amChart",format:"png",output:"dataurlnewwindow",render:"browser",dpi:90,onclick:function(a,d,b){b.preventDefault();a.polifySVG();a.output(d)}},removeImagery:!1};c.processing={buffer:[],drawn:0,timer:0};"undefined"!=typeof window.canvg&&"undefined"!=typeof window.RGBColor&&(c.cfg.menuItemOutput.render=
"canvg");"undefined"!=typeof window.saveAs&&(c.cfg.menuItemOutput.output="save");AmCharts.isIE&&10>AmCharts.IEversion&&(c.cfg.menuItemOutput.output="dataurlnewwindow");b&&(b.menuItemOutput=AmCharts.extend(c.cfg.menuItemOutput,b.menuItemOutput||{}),b.menuItemStyle=AmCharts.extend(c.cfg.menuItemStyle,b.menuItemStyle||{}),c.cfg=AmCharts.extend(c.cfg,b));c.chart.AmExport=c;c.chart.addListener("rendered",function(){c.setup()});c.DEBUG&&(window.AmExport=c)},log:function(){console.log("AmExport: ",arguments)},
setup:function(){10==this.DEBUG&&this.log("SETUP START");!AmCharts.isIE||AmCharts.isIE&&9<AmCharts.IEversion?(this.generateButtons(),10==this.DEBUG&&this.log("SETUP END")):10==this.DEBUG&&this.log("< IE10 NOT SUPPORTED")},generateBinaryArray:function(h){for(var b=h.length,c=new Uint8Array(b/4*3|0),a=0,d=0,k=[0,0],e=0,f=0,g,l,p=new Uint8Array([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,
28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]);b--;)l=h.charCodeAt(a++),g=p[l-43],255!==g&&void 0!==g&&(k[1]=k[0],k[0]=l,f=f<<6|g,e++,4===e&&(c[d++]=f>>>16,61!==k[1]&&(c[d++]=f>>>8),61!==k[0]&&(c[d++]=f),e=0));return c},generateBlob:function(h,b){var c=h.indexOf(",")+1,a=h.substring(0,c),d=h,k=new Blob;-1!=a.indexOf("base64")&&(d=this.generateBinaryArray(h.substring(c)));AmCharts.isIE&&10>AmCharts.IEversion?(k.data=d,k.size=d.length,k.type=b,k.encoding="base64"):k=new Blob([d],
{type:b});return k},generatePDF:function(h){var b={output:function(){return""}},c=this.canvas.toDataURL("image/jpeg"),a=25.4*this.canvas.width/h.dpi;h=25.4*this.canvas.height/h.dpi;window.jsPDF?(b=new jsPDF,b.addImage?b.addImage(c,"JPEG",0,0,a,h):alert("Missing jsPDF plugin; Please add the 'addImage' plugin.")):alert("Missing jsPDF lib; Don't forget to add the addImage plugin.");return b},output:function(h,b){var c=this;h=AmCharts.extend(AmCharts.extend({},c.cfg.menuItemOutput),h||{});return c.generateOutput(h,
function(){var a=null,d;10==c.DEBUG&&c.log("OUTPUT",format);if("image/svg+xml"==h.format||"svg"==h.format)for(var k=0;k<c.processing.buffer.length;k++)a=(new XMLSerializer).serializeToString(c.processing.buffer[k][0]),d=c.generateBlob(a,"image/svg+xml"),"save"==h.output?saveAs(d,h.fileName+".svg"):"datastring"==h.output||"datauristring"==h.output||"dataurlstring"==h.output?d="data:image/svg+xml;base64,"+btoa(a):"dataurlnewwindow"==h.output?window.open("data:image/svg+xml;base64,"+btoa(a)):"datauri"==
h.output||"dataurl"==h.output?location.href="data:image/svg+xml;base64,"+btoa(a):"datastream"==h.output&&(location.href="data:image/octet-stream;base64,"+btoa(a)),b&&b.apply(c,[d]);else if("application/pdf"==h.format||"pdf"==h.format)a=c.generatePDF(h).output("dataurlstring"),d=c.generateBlob(a,"application/pdf"),"save"==h.output?saveAs(d,h.fileName+".pdf"):"datastring"==h.output||"datauristring"==h.output||"dataurlstring"==h.output?d=a:"dataurlnewwindow"==h.output?window.open(a):"datauri"==h.output||
"dataurl"==h.output?location.href=a:"datastream"==h.output&&(location.href=a.replace("application/pdf","application/octet-stream")),b&&b.apply(c,[d]);else if("image/png"==h.format||"png"==h.format)a=c.canvas.toDataURL("image/png"),d=c.generateBlob(a,"image/png"),"save"==h.output?saveAs(d,h.fileName+".png"):"datastring"==h.output||"datauristring"==h.output||"dataurlstring"==h.output?d=a:"dataurlnewwindow"==h.output?window.open(a):"datauri"==h.output||"dataurl"==h.output?location.href=a:"datastream"==
h.output&&(location.href=a.replace("image/png","image/octet-stream")),b&&b.apply(c,[d]);else if("image/jpeg"==h.format||"jpeg"==h.format||"jpg"==h.format)a=c.canvas.toDataURL("image/jpeg"),d=c.generateBlob(a,"image/jpeg"),"save"==h.output?saveAs(d,h.fileName+".jpg"):"datastring"==h.output||"datauristring"==h.output||"dataurlstring"==h.output?d=a:"dataurlnewwindow"==h.output?window.open(a):"datauri"==h.output||"dataurl"==h.output?location.href=a:"datastream"==h.output&&(location.href=a.replace("image/jpeg",
"image/octet-stream")),b&&b.apply(c,[d])})},polifySVG:function(){function h(a,c){for(var e=a.getElementsByTagName(c),f=0;f<e.length;f++){if(b.cfg.removeImagery)e[f].parentNode.removeChild(e[f]);else{var g=document.createElement("img"),l=document.createElement("canvas"),p=l.getContext("2d");l.width=e[f].getAttribute("width");l.height=e[f].getAttribute("height");g.src=e[f].getAttribute("xlink:href");g.width=e[f].getAttribute("width");g.height=e[f].getAttribute("height");try{p.drawImage(g,0,0,g.width,
g.height),datastring=l.toDataURL()}catch(h){throw datastring=g.src,b.log("Tainted canvas, reached browser CORS security; origin from imagery must be equal to the server!"),Error(h);}e[f].setAttribute("xlink:href",datastring)}10==b.DEBUG&&b.log("POLIFIED",e[f])}}for(var b=this,c=b.chart.div.getElementsByTagName("svg"),a=0;a<c.length;a++)10==b.DEBUG&&b.log("POLIFIED",c[a]),h(c[a],"pattern"),h(c[a],"image"),b.svgs.push(c[a]);return c},generateOutput:function(h,b){function c(){var d,f,g;if(a.processing.buffer.length==
a.processing.drawn)return 10==a.DEBUG&&a.log("END DRAWING"),b();10==a.DEBUG&&a.log("DRAW",a.processing.drawn+1,"OF",a.processing.buffer.length);f=a.processing.buffer[a.processing.drawn];g=(new XMLSerializer).serializeToString(f[0]);d=f[1];10==a.DEBUG&&a.log("SOURCE",g);if("browser"==h.render){if(d=new Image,d.id=AmCharts.getUniqueId(),g="data:image/svg+xml;base64,"+btoa(g),d.onload=function(){e.drawImage(this,f[1].x,f[1].y);a.processing.drawn++;10==a.DEBUG&&a.log("ONLOAD",this);c()},d.onerror=function(){10==
a.DEBUG&&a.log("ONERROR",this);e.drawImage(this,f[1].x,f[1].y);a.processing.drawn++;c()},d.src=g,10==a.DEBUG&&a.log("ADD",d),d.complete||"undefined"==typeof d.complete||void 0===d.complete)10==a.DEBUG&&a.log("FORCE ONLOAD",d),d.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",d.src=g}else"canvg"==h.render&&canvg(k,g,{offsetX:d.x,offsetY:d.y,ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,renderCallback:function(){a.processing.drawn++;c()}})}var a=this,
d=a.chart.div.getElementsByTagName("svg"),k=document.createElement("canvas"),e=k.getContext("2d"),f={y:0,x:0},g={};a.processing.buffer=[];a.processing.drawn=0;a.canvas=k;10==a.DEBUG&&a.log("START EXPORT");10==a.DEBUG&&a.log("START BUFFERING");for(var l=0;l<d.length;l++){var p=d[l].parentNode,n=Number(p.style.left.slice(0,-2)),m=Number(p.style.top.slice(0,-2)),g=AmCharts.extend({},f);f.x=n?n:f.x;f.y=m?m:f.y;a.processing.buffer.push([d[l],AmCharts.extend({},f)]);m&&n?f=g:f.y+=m?0:p.offsetHeight;10==
a.DEBUG&&a.log("BUFFERED",d[l],f)}10==a.DEBUG&&a.log("END BUFFERING");10==a.DEBUG&&a.log("START DRAWING",h.render);10==a.DEBUG&&a.log("FILL BACKGROUND");k.id=AmCharts.getUniqueId();k.width=a.chart.divRealWidth;k.height=a.chart.divRealHeight;if(h.backgroundColor||"image/jpeg"==format)e.fillStyle=h.backgroundColor||"#FFFFFF",e.fillRect(0,0,k.width,k.height);return c()},generateButtons:function(){function h(d){var c=document.createElement("ul");c.setAttribute("style","list-style: none; margin: 0; padding: 0;");
for(var e=0;e<d.length;e++){var f=document.createElement("li"),g=document.createElement("img"),l=document.createElement("a"),p=d[e],n=null,m=AmCharts.extend(AmCharts.extend({},b.cfg.menuItemStyle),d[e]),p=AmCharts.extend(AmCharts.extend({},b.cfg.menuItemOutput),p);p.icon&&(g.alt="",g.src=p.icon,g.setAttribute("style","margin: 0 auto;border: none;outline: none"),p.iconTitle&&(g.title=p.iconTitle),l.appendChild(g));l.href="#";p.title&&(g.setAttribute("style","margin-right: 5px;"),l.innerHTML+=p.title);
l.setAttribute("style","display: block;");AmCharts.extend(l.style,m);l.onclick=p.onclick.bind(l,b,p);f.appendChild(l);p.items&&(n=h(p.items),f.appendChild(n),f.onmouseover=function(){n.style.display="block"},f.onmouseout=function(){n.style.display="none"},n.style.display="none");c.appendChild(f);l.onmouseover=function(){this.style.backgroundColor=m.rollOverBackgroundColor;this.style.color=m.rollOverColor;this.style.borderColor=m.rollOverBorderColor};l.onmouseout=function(){this.style.backgroundColor=
m.backgroundColor;this.style.color=m.color;this.style.borderColor=m.borderColor}}a++;10==b.DEBUG&&b.log("MENU",c);return c}var b=this,c=document.createElement("div"),a=0;c.setAttribute("style","width:39px; height:28px; position: absolute;top:"+b.cfg.menuTop+";right:"+b.cfg.menuRight+";bottom:"+b.cfg.menuBottom+";left:"+b.cfg.menuLeft+";box-shadow:0px 0px 1px 0px rgba(0,0,0,0);");c.appendChild(h(b.cfg.menuItems));b.chart.containerDiv.appendChild(c)}});
(function(){function h(){var b={FRAMERATE:30,MAX_VIRTUAL_PIXELS:3E4,init:function(c){var a=0;b.UniqueId=function(){a++;return"canvg"+a};b.Definitions={};b.Styles={};b.Animations=[];b.Images=[];b.ctx=c;b.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};
this.height=function(){return this.Current().height};this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}}};b.init();b.ImagesLoaded=function(){for(var c=0;c<b.Images.length;c++)if(!b.Images[c].loaded)return!1;return!0};b.trim=function(b){return b.replace(/^\s+|\s+$/g,"")};b.compressSpaces=function(b){return b.replace(/[\s\r\t\n]+/gm," ")};b.ajax=function(b){var a;return(a=
window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(a.open("GET",b,!1),a.send(null),a.responseText):null};b.parseXml=function(b){if(window.DOMParser)return(new DOMParser).parseFromString(b,"text/xml");b=b.replace(/<!DOCTYPE svg[^>]*>/,"");var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b);return a};b.Property=function(b,a){this.name=b;this.value=a};b.Property.prototype.getValue=function(){return this.value};b.Property.prototype.hasValue=function(){return null!=
this.value&&""!==this.value};b.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var b=parseFloat(this.value);(this.value+"").match(/%$/)&&(b/=100);return b};b.Property.prototype.valueOrDefault=function(b){return this.hasValue()?this.value:b};b.Property.prototype.numValueOrDefault=function(b){return this.hasValue()?this.numValue():b};b.Property.prototype.addOpacity=function(c){var a=this.value;if(null!=c&&""!=c&&"string"==typeof this.value){var d=new RGBColor(this.value);d.ok&&(a=
"rgba("+d.r+", "+d.g+", "+d.b+", "+c+")")}return new b.Property(this.name,a)};b.Property.prototype.getDefinition=function(){var c=this.value.match(/#([^\)'"]+)/);c&&(c=c[1]);c||(c=this.value);return b.Definitions[c]};b.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")};b.Property.prototype.getFillStyleDefinition=function(c,a){var d=this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(b.ctx,c,a);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var k=
d.attribute("patternTransform"),d=d.getHrefAttribute().getDefinition();k.hasValue()&&(d.attribute("patternTransform",!0).value=k.value)}return d.createPattern(b.ctx,c)}return null};b.Property.prototype.getDPI=function(b){return 96};b.Property.prototype.getEM=function(c){var a=12,d=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);d.hasValue()&&(a=d.toPixels(c));return a};b.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")};b.Property.prototype.toPixels=
function(c,a){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(c);if(d.match(/ex$/))return this.numValue()*this.getEM(c)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(c)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*this.getDPI(c)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(c)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(c);
if(d.match(/%$/))return this.numValue()*b.ViewPort.ComputeSize(c);d=this.numValue();return a&&1>d?d*b.ViewPort.ComputeSize(c):d};b.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var b=this.value+"";if(b.match(/s$/))return 1E3*this.numValue();b.match(/ms$/);return this.numValue()};b.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var b=this.value+"";return b.match(/deg$/)?this.numValue()*(Math.PI/180):b.match(/grad$/)?this.numValue()*(Math.PI/200):b.match(/rad$/)?
this.numValue():this.numValue()*(Math.PI/180)};b.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(a,d,c,e,f,g){g=null!=g?this.Parse(g):this.CreateFont("","","","","",b.ctx.font);return{fontFamily:f||g.fontFamily,fontSize:e||g.fontSize,fontStyle:a||g.fontStyle,fontWeight:c||g.fontWeight,fontVariant:d||g.fontVariant,toString:function(){return[this.fontStyle,
this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var c=this;this.Parse=function(a){var d={};a=b.trim(b.compressSpaces(a||"")).split(" ");for(var k=!1,e=!1,f=!1,g=!1,l="",p=0;p<a.length;p++)e||-1==c.Styles.indexOf(a[p])?g||-1==c.Variants.indexOf(a[p])?f||-1==c.Weights.indexOf(a[p])?k?"inherit"!=a[p]&&(l+=a[p]):("inherit"!=a[p]&&(d.fontSize=a[p].split("/")[0]),e=g=f=k=!0):("inherit"!=a[p]&&(d.fontWeight=a[p]),e=g=f=!0):("inherit"!=a[p]&&(d.fontVariant=a[p]),e=g=!0):("inherit"!=
a[p]&&(d.fontStyle=a[p]),e=!0);""!=l&&(d.fontFamily=l);return d}};b.ToNumberArray=function(c){c=b.trim(b.compressSpaces((c||"").replace(/,/g," "))).split(" ");for(var a=0;a<c.length;a++)c[a]=parseFloat(c[a]);return c};b.Point=function(b,a){this.x=b;this.y=a};b.Point.prototype.angleTo=function(b){return Math.atan2(b.y-this.y,b.x-this.x)};b.Point.prototype.applyTransform=function(b){var a=this.x*b[1]+this.y*b[3]+b[5];this.x=this.x*b[0]+this.y*b[2]+b[4];this.y=a};b.CreatePoint=function(c){c=b.ToNumberArray(c);
return new b.Point(c[0],c[1])};b.CreatePath=function(c){c=b.ToNumberArray(c);for(var a=[],d=0;d<c.length;d+=2)a.push(new b.Point(c[d],c[d+1]));return a};b.BoundingBox=function(b,a,d,k){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(a,b){if(null!=a){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=a;a<this.x1&&(this.x1=
a);a>this.x2&&(this.x2=a)}if(null!=b){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=b;b<this.y1&&(this.y1=b);b>this.y2&&(this.y2=b)}};this.addX=function(a){this.addPoint(a,null)};this.addY=function(a){this.addPoint(null,a)};this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1);this.addPoint(a.x2,a.y2)};this.addQuadraticCurve=function(a,b,d,c,k,h){d=a+2/3*(d-a);c=b+2/3*(c-b);this.addBezierCurve(a,b,d,d+1/3*(k-a),c,c+1/3*(h-b),k,h)};this.addBezierCurve=function(a,b,d,c,k,h,m,q){var s=[a,b],r=
[d,c],t=[k,h],u=[m,q];this.addPoint(s[0],s[1]);this.addPoint(u[0],u[1]);for(i=0;1>=i;i++)a=function(a){return Math.pow(1-a,3)*s[i]+3*Math.pow(1-a,2)*a*r[i]+3*(1-a)*Math.pow(a,2)*t[i]+Math.pow(a,3)*u[i]},b=6*s[i]-12*r[i]+6*t[i],d=-3*s[i]+9*r[i]-9*t[i]+3*u[i],c=3*r[i]-3*s[i],0==d?0!=b&&(b=-c/b,0<b&&1>b&&(0==i&&this.addX(a(b)),1==i&&this.addY(a(b)))):(c=Math.pow(b,2)-4*c*d,0>c||(k=(-b+Math.sqrt(c))/(2*d),0<k&&1>k&&(0==i&&this.addX(a(k)),1==i&&this.addY(a(k))),b=(-b-Math.sqrt(c))/(2*d),0<b&&1>b&&(0==
i&&this.addX(a(b)),1==i&&this.addY(a(b)))))};this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2};this.addPoint(b,a);this.addPoint(d,k)};b.Transform=function(c){var a=this;this.Type={};this.Type.translate=function(a){this.p=b.CreatePoint(a);this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)};this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=
function(a){a=b.ToNumberArray(a);this.angle=new b.Property("angle",a[0]);this.cx=a[1]||0;this.cy=a[2]||0;this.apply=function(a){a.translate(this.cx,this.cy);a.rotate(this.angle.toRadians());a.translate(-this.cx,-this.cy)};this.unapply=function(a){a.translate(this.cx,this.cy);a.rotate(-1*this.angle.toRadians());a.translate(-this.cx,-this.cy)};this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),
Math.cos(b),0,0]);a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(a){this.p=b.CreatePoint(a);this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(a){this.m=b.ToNumberArray(a);this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};
this.applyToPoint=function(a){a.applyTransform(this.m)}};this.Type.SkewBase=function(d){this.base=a.Type.matrix;this.base(d);this.angle=new b.Property("angle",d)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(b){this.base=a.Type.SkewBase;this.base(b);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(b){this.base=a.Type.SkewBase;this.base(b);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};
this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)};this.unapply=function(a){for(var b=this.transforms.length-1;0<=b;b--)this.transforms[b].unapply(a)};this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};c=b.trim(b.compressSpaces(c)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/);for(var d=0;d<c.length;d++){var k=b.trim(c[d].split("(")[0]),
e=c[d].split("(")[1].replace(")",""),e=new this.Type[k](e);e.type=k;this.transforms.push(e)}};b.AspectRatio=function(c,a,d,k,e,f,g,l,p,h){a=b.compressSpaces(a);a=a.replace(/^defer\s/,"");var m=a.split(" ")[0]||"xMidYMid";a=a.split(" ")[1]||"meet";var q=d/k,s=e/f,r=Math.min(q,s),t=Math.max(q,s);"meet"==a&&(k*=r,f*=r);"slice"==a&&(k*=t,f*=t);p=new b.Property("refX",p);h=new b.Property("refY",h);p.hasValue()&&h.hasValue()?c.translate(-r*p.toPixels("x"),-r*h.toPixels("y")):(m.match(/^xMid/)&&("meet"==
a&&r==s||"slice"==a&&t==s)&&c.translate(d/2-k/2,0),m.match(/YMid$/)&&("meet"==a&&r==q||"slice"==a&&t==q)&&c.translate(0,e/2-f/2),m.match(/^xMax/)&&("meet"==a&&r==s||"slice"==a&&t==s)&&c.translate(d-k,0),m.match(/YMax$/)&&("meet"==a&&r==q||"slice"==a&&t==q)&&c.translate(0,e-f));"none"==m?c.scale(q,s):"meet"==a?c.scale(r,r):"slice"==a&&c.scale(t,t);c.translate(null==g?0:-g,null==l?0:-l)};b.Element={};b.EmptyProperty=new b.Property("EMPTY","");b.Element.ElementBase=function(c){this.attributes={};this.styles=
{};this.children=[];this.attribute=function(a,d){var c=this.attributes[a];if(null!=c)return c;!0==d&&(c=new b.Property(a,""),this.attributes[a]=c);return c||b.EmptyProperty};this.getHrefAttribute=function(){for(var a in this.attributes)if(a.match(/:href$/))return this.attributes[a];return b.EmptyProperty};this.style=function(a,d){var c=this.styles[a];if(null!=c)return c;var k=this.attribute(a);if(null!=k&&k.hasValue())return this.styles[a]=k;k=this.parent;if(null!=k&&(k=k.style(a),null!=k&&k.hasValue()))return k;
!0==d&&(c=new b.Property(a,""),this.styles[a]=c);return c||b.EmptyProperty};this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){a.save();if(this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else this.style("filter").hasValue()?(b=this.style("filter").getDefinition(),null!=b&&b.apply(a,this)):(this.setContext(a),this.renderChildren(a),this.clearContext(a));a.restore()}};this.setContext=
function(a){};this.clearContext=function(a){};this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)};this.addChild=function(a,d){var c=a;d&&(c=b.CreateElement(a));c.parent=this;this.children.push(c)};if(null!=c&&1==c.nodeType){for(var a=0;a<c.childNodes.length;a++){var d=c.childNodes[a];1==d.nodeType&&this.addChild(d,!0);this.captureTextNodes&&3==d.nodeType&&""!=b.trim(b.compressSpaces(d.nodeValue||d.text||""))&&this.addChild(new b.Element.tspan(d),!1)}for(a=
0;a<c.attributes.length;a++)d=c.attributes[a],this.attributes[d.nodeName]=new b.Property(d.nodeName,d.nodeValue);d=b.Styles[c.nodeName];if(null!=d)for(var k in d)this.styles[k]=d[k];if(this.attribute("class").hasValue())for(var a=b.compressSpaces(this.attribute("class").value).split(" "),e=0;e<a.length;e++){d=b.Styles["."+a[e]];if(null!=d)for(k in d)this.styles[k]=d[k];d=b.Styles[c.nodeName+"."+a[e]];if(null!=d)for(k in d)this.styles[k]=d[k]}if(this.attribute("id").hasValue()&&(d=b.Styles["#"+this.attribute("id").value],
null!=d))for(k in d)this.styles[k]=d[k];if(this.attribute("style").hasValue())for(d=this.attribute("style").value.split(";"),a=0;a<d.length;a++)""!=b.trim(d[a])&&(c=d[a].split(":"),k=b.trim(c[0]),c=b.trim(c[1]),this.styles[k]=new b.Property(k,c));this.attribute("id").hasValue()&&null==b.Definitions[this.attribute("id").value]&&(b.Definitions[this.attribute("id").value]=this)}};b.Element.RenderedElementBase=function(c){this.base=b.Element.ElementBase;this.base(c);this.setContext=function(a){if(this.style("fill").isUrlDefinition()){var d=
this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=d&&(a.fillStyle=d)}else this.style("fill").hasValue()&&(d=this.style("fill"),"currentColor"==d.value&&(d.value=this.style("color").value),a.fillStyle="none"==d.value?"rgba(0,0,0,0)":d.value);this.style("fill-opacity").hasValue()&&(d=new b.Property("fill",a.fillStyle),d=d.addOpacity(this.style("fill-opacity").value),a.fillStyle=d.value);this.style("stroke").isUrlDefinition()?(d=this.style("stroke").getFillStyleDefinition(this,
this.style("stroke-opacity")),null!=d&&(a.strokeStyle=d)):this.style("stroke").hasValue()&&(d=this.style("stroke"),"currentColor"==d.value&&(d.value=this.style("color").value),a.strokeStyle="none"==d.value?"rgba(0,0,0,0)":d.value);this.style("stroke-opacity").hasValue()&&(d=new b.Property("stroke",a.strokeStyle),d=d.addOpacity(this.style("stroke-opacity").value),a.strokeStyle=d.value);this.style("stroke-width").hasValue()&&(d=this.style("stroke-width").toPixels(),a.lineWidth=0==d?0.001:d);this.style("stroke-linecap").hasValue()&&
(a.lineCap=this.style("stroke-linecap").value);this.style("stroke-linejoin").hasValue()&&(a.lineJoin=this.style("stroke-linejoin").value);this.style("stroke-miterlimit").hasValue()&&(a.miterLimit=this.style("stroke-miterlimit").value);this.style("stroke-dasharray").hasValue()&&(d=b.ToNumberArray(this.style("stroke-dasharray").value),"undefined"!=typeof a.setLineDash?a.setLineDash(d):"undefined"!=typeof a.webkitLineDash?a.webkitLineDash=d:"undefined"!=typeof a.mozDash&&(a.mozDash=d),d=this.style("stroke-dashoffset").numValueOrDefault(1),
"undefined"!=typeof a.lineDashOffset?a.lineDashOffset=d:"undefined"!=typeof a.webkitLineDashOffset?a.webkitLineDashOffset=d:"undefined"!=typeof a.mozDashOffset&&(a.mozDashOffset=d));"undefined"!=typeof a.font&&(a.font=b.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString());this.attribute("transform").hasValue()&&(new b.Transform(this.attribute("transform").value)).apply(a);
this.style("clip-path").hasValue()&&(d=this.style("clip-path").getDefinition(),null!=d&&d.apply(a));this.style("opacity").hasValue()&&(a.globalAlpha=this.style("opacity").numValue())}};b.Element.RenderedElementBase.prototype=new b.Element.ElementBase;b.Element.PathElementBase=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.path=function(a){null!=a&&a.beginPath();return new b.BoundingBox};this.renderChildren=function(a){this.path(a);b.Mouse.checkPath(this,a);""!=a.fillStyle&&
(this.attribute("fill-rule").hasValue()?a.fill(this.attribute("fill-rule").value):a.fill());""!=a.strokeStyle&&a.stroke();var d=this.getMarkers();if(null!=d){if(this.style("marker-start").isUrlDefinition()){var c=this.style("marker-start").getDefinition();c.render(a,d[0][0],d[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var c=this.style("marker-mid").getDefinition(),e=1;e<d.length-1;e++)c.render(a,d[e][0],d[e][1]);this.style("marker-end").isUrlDefinition()&&(c=this.style("marker-end").getDefinition(),
c.render(a,d[d.length-1][0],d[d.length-1][1]))}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};b.Element.PathElementBase.prototype=new b.Element.RenderedElementBase;b.Element.svg=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseClearContext=this.clearContext;this.clearContext=function(a){this.baseClearContext(a);b.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)";
a.lineCap="butt";a.lineJoin="miter";a.miterLimit=4;this.baseSetContext(a);this.attribute("x").hasValue()||(this.attribute("x",!0).value=0);this.attribute("y").hasValue()||(this.attribute("y",!0).value=0);a.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var d=b.ViewPort.width(),c=b.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%");this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%");if("undefined"==
typeof this.root){var d=this.attribute("width").toPixels("x"),c=this.attribute("height").toPixels("y"),e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y"));a.beginPath();a.moveTo(e,f);a.lineTo(d,f);a.lineTo(d,c);a.lineTo(e,c);a.closePath();a.clip()}b.ViewPort.SetCurrent(d,c);if(this.attribute("viewBox").hasValue()){var e=b.ToNumberArray(this.attribute("viewBox").value),f=e[0],g=e[1],d=e[2],c=
e[3];b.AspectRatio(a,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),d,b.ViewPort.height(),c,f,g,this.attribute("refX").value,this.attribute("refY").value);b.ViewPort.RemoveCurrent();b.ViewPort.SetCurrent(e[2],e[3])}}};b.Element.svg.prototype=new b.Element.RenderedElementBase;b.Element.rect=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(a){var d=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),
f=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),l=this.attribute("ry").toPixels("y");this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(l=g);this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=l);g=Math.min(g,e/2);l=Math.min(l,f/2);null!=a&&(a.beginPath(),a.moveTo(d+g,c),a.lineTo(d+e-g,c),a.quadraticCurveTo(d+e,c,d+e,c+l),a.lineTo(d+e,c+f-l),a.quadraticCurveTo(d+e,c+f,d+e-g,c+f),a.lineTo(d+g,c+f),a.quadraticCurveTo(d,c+f,d,c+f-l),a.lineTo(d,
c+l),a.quadraticCurveTo(d,c,d+g,c),a.closePath());return new b.BoundingBox(d,c,d+e,c+f)}};b.Element.rect.prototype=new b.Element.PathElementBase;b.Element.circle=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(a){var d=this.attribute("cx").toPixels("x"),c=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();null!=a&&(a.beginPath(),a.arc(d,c,e,0,2*Math.PI,!0),a.closePath());return new b.BoundingBox(d-e,c-e,d+e,c+e)}};b.Element.circle.prototype=new b.Element.PathElementBase;
b.Element.ellipse=function(c){this.base=b.Element.PathElementBase;this.base(c);this.path=function(a){var d=4*((Math.sqrt(2)-1)/3),c=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),f=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");null!=a&&(a.beginPath(),a.moveTo(f,g-e),a.bezierCurveTo(f+d*c,g-e,f+c,g-d*e,f+c,g),a.bezierCurveTo(f+c,g+d*e,f+d*c,g+e,f,g+e),a.bezierCurveTo(f-d*c,g+e,f-c,g+d*e,f-c,g),a.bezierCurveTo(f-c,g-d*e,f-d*c,g-e,f,g-e),a.closePath());
return new b.BoundingBox(f-c,g-e,f+c,g+e)}};b.Element.ellipse.prototype=new b.Element.PathElementBase;b.Element.line=function(c){this.base=b.Element.PathElementBase;this.base(c);this.getPoints=function(){return[new b.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new b.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(a){var d=this.getPoints();null!=a&&(a.beginPath(),a.moveTo(d[0].x,d[0].y),a.lineTo(d[1].x,d[1].y));return new b.BoundingBox(d[0].x,
d[0].y,d[1].x,d[1].y)};this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}};b.Element.line.prototype=new b.Element.PathElementBase;b.Element.polyline=function(c){this.base=b.Element.PathElementBase;this.base(c);this.points=b.CreatePath(this.attribute("points").value);this.path=function(a){var d=new b.BoundingBox(this.points[0].x,this.points[0].y);null!=a&&(a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y));for(var c=1;c<this.points.length;c++)d.addPoint(this.points[c].x,
this.points[c].y),null!=a&&a.lineTo(this.points[c].x,this.points[c].y);return d};this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);a.push([this.points[this.points.length-1],a[a.length-1][1]]);return a}};b.Element.polyline.prototype=new b.Element.PathElementBase;b.Element.polygon=function(c){this.base=b.Element.polyline;this.base(c);this.basePath=this.path;this.path=function(a){var b=this.basePath(a);null!=a&&(a.lineTo(this.points[0].x,
this.points[0].y),a.closePath());return b}};b.Element.polygon.prototype=new b.Element.polyline;b.Element.path=function(c){this.base=b.Element.PathElementBase;this.base(c);c=this.attribute("d").value;c=c.replace(/,/gm," ");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([0-9])([+\-])/gm,
"$1 $2");c=c.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");c=b.compressSpaces(c);c=b.trim(c);this.PathParser=new function(a){this.tokens=a.split(" ");this.reset=function(){this.i=-1;this.previousCommand=this.command="";this.start=new b.Point(0,0);this.control=new b.Point(0,0);this.current=new b.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?
!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)};this.isRelativeCommand=function(){switch(this.command){case "m":case "l":case "h":case "v":case "c":case "s":case "q":case "t":case "a":case "z":return!0}return!1};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var a=new b.Point(this.getScalar(),this.getScalar());
return this.makeAbsolute(a)};this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a};this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a};this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new b.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};this.makeAbsolute=
function(a){this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y);return a};this.addMarker=function(a,b,c){null!=c&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c));this.addMarkerAngle(a,null==b?null:b.angleTo(a))};this.addMarkerAngle=function(a,b){this.points.push(a);this.angles.push(b)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==
this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(c);this.path=function(a){var d=this.PathParser;d.reset();var c=new b.BoundingBox;for(null!=a&&a.beginPath();!d.isEnd();)switch(d.nextCommand(),d.command){case "M":case "m":var e=d.getAsCurrentPoint();d.addMarker(e);c.addPoint(e.x,e.y);null!=a&&a.moveTo(e.x,e.y);for(d.start=d.current;!d.isCommandOrEnd();)e=d.getAsCurrentPoint(),d.addMarker(e,d.start),c.addPoint(e.x,
e.y),null!=a&&a.lineTo(e.x,e.y);break;case "L":case "l":for(;!d.isCommandOrEnd();){var f=d.current,e=d.getAsCurrentPoint();d.addMarker(e,f);c.addPoint(e.x,e.y);null!=a&&a.lineTo(e.x,e.y)}break;case "H":case "h":for(;!d.isCommandOrEnd();)e=new b.Point((d.isRelativeCommand()?d.current.x:0)+d.getScalar(),d.current.y),d.addMarker(e,d.current),d.current=e,c.addPoint(d.current.x,d.current.y),null!=a&&a.lineTo(d.current.x,d.current.y);break;case "V":case "v":for(;!d.isCommandOrEnd();)e=new b.Point(d.current.x,
(d.isRelativeCommand()?d.current.y:0)+d.getScalar()),d.addMarker(e,d.current),d.current=e,c.addPoint(d.current.x,d.current.y),null!=a&&a.lineTo(d.current.x,d.current.y);break;case "C":case "c":for(;!d.isCommandOrEnd();){var g=d.current,f=d.getPoint(),l=d.getAsControlPoint(),e=d.getAsCurrentPoint();d.addMarker(e,l,f);c.addBezierCurve(g.x,g.y,f.x,f.y,l.x,l.y,e.x,e.y);null!=a&&a.bezierCurveTo(f.x,f.y,l.x,l.y,e.x,e.y)}break;case "S":case "s":for(;!d.isCommandOrEnd();)g=d.current,f=d.getReflectedControlPoint(),
l=d.getAsControlPoint(),e=d.getAsCurrentPoint(),d.addMarker(e,l,f),c.addBezierCurve(g.x,g.y,f.x,f.y,l.x,l.y,e.x,e.y),null!=a&&a.bezierCurveTo(f.x,f.y,l.x,l.y,e.x,e.y);break;case "Q":case "q":for(;!d.isCommandOrEnd();)g=d.current,l=d.getAsControlPoint(),e=d.getAsCurrentPoint(),d.addMarker(e,l,l),c.addQuadraticCurve(g.x,g.y,l.x,l.y,e.x,e.y),null!=a&&a.quadraticCurveTo(l.x,l.y,e.x,e.y);break;case "T":case "t":for(;!d.isCommandOrEnd();)g=d.current,l=d.getReflectedControlPoint(),d.control=l,e=d.getAsCurrentPoint(),
d.addMarker(e,l,l),c.addQuadraticCurve(g.x,g.y,l.x,l.y,e.x,e.y),null!=a&&a.quadraticCurveTo(l.x,l.y,e.x,e.y);break;case "A":case "a":for(;!d.isCommandOrEnd();){var g=d.current,h=d.getScalar(),n=d.getScalar(),f=d.getScalar()*(Math.PI/180),m=d.getScalar(),l=d.getScalar(),e=d.getAsCurrentPoint(),q=new b.Point(Math.cos(f)*(g.x-e.x)/2+Math.sin(f)*(g.y-e.y)/2,-Math.sin(f)*(g.x-e.x)/2+Math.cos(f)*(g.y-e.y)/2),s=Math.pow(q.x,2)/Math.pow(h,2)+Math.pow(q.y,2)/Math.pow(n,2);1<s&&(h*=Math.sqrt(s),n*=Math.sqrt(s));
m=(m==l?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(n,2)-Math.pow(h,2)*Math.pow(q.y,2)-Math.pow(n,2)*Math.pow(q.x,2))/(Math.pow(h,2)*Math.pow(q.y,2)+Math.pow(n,2)*Math.pow(q.x,2)));isNaN(m)&&(m=0);var r=new b.Point(m*h*q.y/n,m*-n*q.x/h),g=new b.Point((g.x+e.x)/2+Math.cos(f)*r.x-Math.sin(f)*r.y,(g.y+e.y)/2+Math.sin(f)*r.x+Math.cos(f)*r.y),t=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},u=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(t(a)*t(b))},v=function(a,b){return(a[0]*b[1]<a[1]*b[0]?
-1:1)*Math.acos(u(a,b))},m=v([1,0],[(q.x-r.x)/h,(q.y-r.y)/n]),s=[(q.x-r.x)/h,(q.y-r.y)/n],r=[(-q.x-r.x)/h,(-q.y-r.y)/n],q=v(s,r);-1>=u(s,r)&&(q=Math.PI);1<=u(s,r)&&(q=0);s=1-l?1:-1;r=m+q/2*s;v=new b.Point(g.x+h*Math.cos(r),g.y+n*Math.sin(r));d.addMarkerAngle(v,r-s*Math.PI/2);d.addMarkerAngle(e,r-s*Math.PI);c.addPoint(e.x,e.y);null!=a&&(u=h>n?h:n,e=h>n?1:h/n,h=h>n?n/h:1,a.translate(g.x,g.y),a.rotate(f),a.scale(e,h),a.arc(0,0,u,m,m+q,1-l),a.scale(1/e,1/h),a.rotate(-f),a.translate(-g.x,-g.y))}break;
case "Z":case "z":null!=a&&a.closePath(),d.current=d.start}return c};this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],e=0;e<a.length;e++)c.push([a[e],b[e]]);return c}};b.Element.path.prototype=new b.Element.PathElementBase;b.Element.pattern=function(c){this.base=b.Element.ElementBase;this.base(c);this.createPattern=function(a,d){var c=this.attribute("width").toPixels("x",!0),e=this.attribute("height").toPixels("y",!0),f=new b.Element.svg;
f.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value);f.attributes.width=new b.Property("width",c+"px");f.attributes.height=new b.Property("height",e+"px");f.attributes.transform=new b.Property("transform",this.attribute("patternTransform").value);f.children=this.children;var g=document.createElement("canvas");g.width=c;g.height=e;c=g.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&c.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",
!0));for(e=-1;1>=e;e++)for(var l=-1;1>=l;l++)c.save(),c.translate(e*g.width,l*g.height),f.render(c),c.restore();return a.createPattern(g,"repeat")}};b.Element.pattern.prototype=new b.Element.ElementBase;b.Element.marker=function(c){this.base=b.Element.ElementBase;this.base(c);this.baseRender=this.render;this.render=function(a,d,c){a.translate(d.x,d.y);"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(c);"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(a.lineWidth,
a.lineWidth);a.save();var e=new b.Element.svg;e.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value);e.attributes.refX=new b.Property("refX",this.attribute("refX").value);e.attributes.refY=new b.Property("refY",this.attribute("refY").value);e.attributes.width=new b.Property("width",this.attribute("markerWidth").value);e.attributes.height=new b.Property("height",this.attribute("markerHeight").value);e.attributes.fill=new b.Property("fill",this.attribute("fill").valueOrDefault("black"));
e.attributes.stroke=new b.Property("stroke",this.attribute("stroke").valueOrDefault("none"));e.children=this.children;e.render(a);a.restore();"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(1/a.lineWidth,1/a.lineWidth);"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-c);a.translate(-d.x,-d.y)}};b.Element.marker.prototype=new b.Element.ElementBase;b.Element.defs=function(c){this.base=b.Element.ElementBase;this.base(c);this.render=function(a){}};
b.Element.defs.prototype=new b.Element.ElementBase;b.Element.GradientBase=function(c){this.base=b.Element.ElementBase;this.base(c);this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox");this.stops=[];for(c=0;c<this.children.length;c++){var a=this.children[c];"stop"==a.type&&this.stops.push(a)}this.getGradient=function(){};this.createGradient=function(a,c,e){var f=this;this.getHrefAttribute().hasValue()&&(f=this.getHrefAttribute().getDefinition());var g=function(a){return e.hasValue()?
(new b.Property("color",a)).addOpacity(e.value).value:a};a=this.getGradient(a,c);if(null==a)return g(f.stops[f.stops.length-1].color);for(c=0;c<f.stops.length;c++)a.addColorStop(f.stops[c].offset,g(f.stops[c].color));return this.attribute("gradientTransform").hasValue()?(f=b.ViewPort.viewPorts[0],g=new b.Element.rect,g.attributes.x=new b.Property("x",-b.MAX_VIRTUAL_PIXELS/3),g.attributes.y=new b.Property("y",-b.MAX_VIRTUAL_PIXELS/3),g.attributes.width=new b.Property("width",b.MAX_VIRTUAL_PIXELS),
g.attributes.height=new b.Property("height",b.MAX_VIRTUAL_PIXELS),c=new b.Element.g,c.attributes.transform=new b.Property("transform",this.attribute("gradientTransform").value),c.children=[g],g=new b.Element.svg,g.attributes.x=new b.Property("x",0),g.attributes.y=new b.Property("y",0),g.attributes.width=new b.Property("width",f.width),g.attributes.height=new b.Property("height",f.height),g.children=[c],c=document.createElement("canvas"),c.width=f.width,c.height=f.height,f=c.getContext("2d"),f.fillStyle=
a,g.render(f),f.createPattern(c,"no-repeat")):a}};b.Element.GradientBase.prototype=new b.Element.ElementBase;b.Element.linearGradient=function(c){this.base=b.Element.GradientBase;this.base(c);this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=
0);var e="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),f="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),g="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),c="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");
return e==g&&f==c?null:a.createLinearGradient(e,f,g,c)}};b.Element.linearGradient.prototype=new b.Element.GradientBase;b.Element.radialGradient=function(c){this.base=b.Element.GradientBase;this.base(c);this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%");this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%");this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var e="objectBoundingBox"==this.gradientUnits?
c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),f="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),g=e,l=f;this.attribute("fx").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x"));this.attribute("fy").hasValue()&&(l="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("fy").numValue():
this.attribute("fy").toPixels("y"));c="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(g,l,0,e,f,c)}};b.Element.radialGradient.prototype=new b.Element.GradientBase;b.Element.stop=function(c){this.base=b.Element.ElementBase;this.base(c);this.offset=this.attribute("offset").numValue();0>this.offset&&(this.offset=0);1<this.offset&&(this.offset=1);c=this.style("stop-color");this.style("stop-opacity").hasValue()&&
(c=c.addOpacity(this.style("stop-opacity").value));this.color=c.value};b.Element.stop.prototype=new b.Element.ElementBase;b.Element.AnimateBase=function(c){this.base=b.Element.ElementBase;this.base(c);b.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,
!0):this.parent.attribute(b,!0)};this.initialValue=null;this.initialUnits="";this.removed=!1;this.calcValue=function(){return""};this.update=function(a){null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits());if(this.duration>this.maxDuration)if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else{if("remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed)return!1;
this.removed=!0;this.getProperty().value=this.initialValue;return!0}this.duration+=a;a=!1;this.begin<this.duration&&(a=this.calcValue(),this.attribute("type").hasValue()&&(a=this.attribute("type").value+"("+a+")"),this.getProperty().value=a,a=!0);return a};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");this.values.hasValue()&&(this.values.value=this.values.value.split(";"));this.progress=function(){var a={progress:(this.duration-this.begin)/(this.maxDuration-
this.begin)};if(this.values.hasValue()){var d=a.progress*(this.values.value.length-1),c=Math.floor(d),e=Math.ceil(d);a.from=new b.Property("from",parseFloat(this.values.value[c]));a.to=new b.Property("to",parseFloat(this.values.value[e]));a.progress=(d-c)/(e-c)}else a.from=this.from,a.to=this.to;return a}};b.Element.AnimateBase.prototype=new b.Element.ElementBase;b.Element.animate=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=this.progress();return a.from.numValue()+
(a.to.numValue()-a.from.numValue())*a.progress+this.initialUnits}};b.Element.animate.prototype=new b.Element.AnimateBase;b.Element.animateColor=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=this.progress(),b=new RGBColor(a.from.value),c=new RGBColor(a.to.value);if(b.ok&&c.ok){var e=b.g+(c.g-b.g)*a.progress,f=b.b+(c.b-b.b)*a.progress;return"rgb("+parseInt(b.r+(c.r-b.r)*a.progress,10)+","+parseInt(e,10)+","+parseInt(f,10)+")"}return this.attribute("from").value}};
b.Element.animateColor.prototype=new b.Element.AnimateBase;b.Element.animateTransform=function(c){this.base=b.Element.AnimateBase;this.base(c);this.calcValue=function(){for(var a=this.progress(),c=b.ToNumberArray(a.from.value),k=b.ToNumberArray(a.to.value),e="",f=0;f<c.length;f++)e+=c[f]+(k[f]-c[f])*a.progress+" ";return e}};b.Element.animateTransform.prototype=new b.Element.animate;b.Element.font=function(c){this.base=b.Element.ElementBase;this.base(c);this.horizAdvX=this.attribute("horiz-adv-x").numValue();
this.isArabic=this.isRTL=!1;this.missingGlyph=this.fontFace=null;this.glyphs=[];for(c=0;c<this.children.length;c++){var a=this.children[c];"font-face"==a.type?(this.fontFace=a,a.style("font-family").hasValue()&&(b.Definitions[a.style("font-family").value]=this)):"missing-glyph"==a.type?this.missingGlyph=a:"glyph"==a.type&&(""!=a.arabicForm?(this.isArabic=this.isRTL=!0,"undefined"==typeof this.glyphs[a.unicode]&&(this.glyphs[a.unicode]=[]),this.glyphs[a.unicode][a.arabicForm]=a):this.glyphs[a.unicode]=
a)}};b.Element.font.prototype=new b.Element.ElementBase;b.Element.fontface=function(c){this.base=b.Element.ElementBase;this.base(c);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};b.Element.fontface.prototype=new b.Element.ElementBase;b.Element.missingglyph=function(c){this.base=b.Element.path;this.base(c);this.horizAdvX=0};b.Element.missingglyph.prototype=new b.Element.path;b.Element.glyph=function(c){this.base=
b.Element.path;this.base(c);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};b.Element.glyph.prototype=new b.Element.path;b.Element.text=function(c){this.captureTextNodes=!0;this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);this.style("dominant-baseline").hasValue()&&(a.textBaseline=this.style("dominant-baseline").value);
this.style("alignment-baseline").hasValue()&&(a.textBaseline=this.style("alignment-baseline").value)};this.getBoundingBox=function(){return new b.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)};this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)};this.getAnchorDelta=function(a,b,c){var e=this.style("text-anchor").valueOrDefault("start");
if("start"!=e){for(var f=0,g=c;g<b.children.length;g++){var l=b.children[g];if(g>c&&l.attribute("x").hasValue())break;f+=l.measureTextRecursive(a)}return-1*("end"==e?f:f/2)}return 0};this.renderChild=function(a,b,c){var e=b.children[c];e.attribute("x").hasValue()?e.x=e.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),e.attribute("dx").hasValue()&&(this.x+=e.attribute("dx").toPixels("x")),e.x=this.x);this.x=e.x+e.measureText(a);
e.attribute("y").hasValue()?e.y=e.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),e.attribute("dy").hasValue()&&(this.y+=e.attribute("dy").toPixels("y")),e.y=this.y);this.y=e.y;e.render(a);for(c=0;c<e.children.length;c++)this.renderChild(a,e,c)}};b.Element.text.prototype=new b.Element.RenderedElementBase;b.Element.TextElementBase=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.getGlyph=function(a,b,c){var e=b[c],f=null;
if(a.isArabic){var g="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(g="terminal");0<c&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(g="medial");0<c&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(g="initial");"undefined"!=typeof a.glyphs[e]&&(f=a.glyphs[e][g],null==f&&"glyph"==a.glyphs[e].type&&(f=a.glyphs[e]))}else f=a.glyphs[e];null==f&&(f=a.missingGlyph);return f};this.renderChildren=function(a){var c=this.parent.style("font-family").getDefinition();if(null!=c){var k=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),
e=this.parent.style("font-style").valueOrDefault(b.Font.Parse(b.ctx.font).fontStyle),f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=b.ToNumberArray(this.parent.attribute("dx").value),l=0;l<f.length;l++){var h=this.getGlyph(c,f,l),n=k/c.fontFace.unitsPerEm;a.translate(this.x,this.y);a.scale(n,-n);var m=a.lineWidth;a.lineWidth=a.lineWidth*c.fontFace.unitsPerEm/k;"italic"==e&&a.transform(1,0,0.4,1,0,0);h.render(a);"italic"==e&&a.transform(1,0,-0.4,1,0,0);a.lineWidth=m;a.scale(1/
n,-1/n);a.translate(-this.x,-this.y);this.x+=k*(h.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm;"undefined"==typeof g[l]||isNaN(g[l])||(this.x+=g[l])}}else""!=a.fillStyle&&a.fillText(b.compressSpaces(this.getText()),this.x,this.y),""!=a.strokeStyle&&a.strokeText(b.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b};this.measureText=
function(a){var c=this.parent.style("font-family").getDefinition();if(null!=c){a=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize);var k=0,e=this.getText();c.isRTL&&(e=e.split("").reverse().join(""));for(var f=b.ToNumberArray(this.parent.attribute("dx").value),g=0;g<e.length;g++){var l=this.getGlyph(c,e,g),k=k+(l.horizAdvX||c.horizAdvX)*a/c.fontFace.unitsPerEm;"undefined"==typeof f[g]||isNaN(f[g])||(k+=f[g])}return k}c=b.compressSpaces(this.getText());if(!a.measureText)return 10*
c.length;a.save();this.setContext(a);c=a.measureText(c).width;a.restore();return c}};b.Element.TextElementBase.prototype=new b.Element.RenderedElementBase;b.Element.tspan=function(c){this.captureTextNodes=!0;this.base=b.Element.TextElementBase;this.base(c);this.text=c.nodeValue||c.text||"";this.getText=function(){return this.text}};b.Element.tspan.prototype=new b.Element.TextElementBase;b.Element.tref=function(c){this.base=b.Element.TextElementBase;this.base(c);this.getText=function(){var a=this.getHrefAttribute().getDefinition();
if(null!=a)return a.children[0].getText()}};b.Element.tref.prototype=new b.Element.TextElementBase;b.Element.a=function(c){this.base=b.Element.TextElementBase;this.base(c);this.hasText=!0;for(var a=0;a<c.childNodes.length;a++)3!=c.childNodes[a].nodeType&&(this.hasText=!1);this.text=this.hasText?c.childNodes[0].nodeValue:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);var c=new b.Property("fontSize",
b.Font.Parse(b.ctx.font).fontSize);b.Mouse.checkBoundingBox(this,new b.BoundingBox(this.x,this.y-c.toPixels("y"),this.x+this.measureText(a),this.y))}else c=new b.Element.g,c.children=this.children,c.parent=this,c.render(a)};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){b.ctx.canvas.style.cursor="pointer"}};b.Element.a.prototype=new b.Element.TextElementBase;b.Element.image=function(c){this.base=b.Element.RenderedElementBase;this.base(c);var a=this.getHrefAttribute().value,
d=a.match(/\.svg$/);b.Images.push(this);this.loaded=!1;if(d)this.img=b.ajax(a),this.loaded=!0;else{this.img=document.createElement("img");var k=this;this.img.onload=function(){k.loaded=!0};this.img.onerror=function(){"undefined"!=typeof console&&(console.log('ERROR: image "'+a+'" not found'),k.loaded=!0)};this.img.src=a}this.renderChildren=function(a){var c=this.attribute("x").toPixels("x"),g=this.attribute("y").toPixels("y"),k=this.attribute("width").toPixels("x"),h=this.attribute("height").toPixels("y");
0!=k&&0!=h&&(a.save(),d?a.drawSvg(this.img,c,g,k,h):(a.translate(c,g),b.AspectRatio(a,this.attribute("preserveAspectRatio").value,k,this.img.width,h,this.img.height,0,0),a.drawImage(this.img,0,0)),a.restore())};this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),k=this.attribute("height").toPixels("y");return new b.BoundingBox(a,c,a+d,c+k)}};b.Element.image.prototype=new b.Element.RenderedElementBase;b.Element.g=
function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.getBoundingBox=function(){for(var a=new b.BoundingBox,c=0;c<this.children.length;c++)a.addBoundingBox(this.children[c].getBoundingBox());return a}};b.Element.g.prototype=new b.Element.RenderedElementBase;b.Element.symbol=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);if(this.attribute("viewBox").hasValue()){var c=b.ToNumberArray(this.attribute("viewBox").value),
k=c[0],e=c[1];width=c[2];height=c[3];b.AspectRatio(a,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,k,e);b.ViewPort.SetCurrent(c[2],c[3])}}};b.Element.symbol.prototype=new b.Element.RenderedElementBase;b.Element.style=function(c){this.base=b.Element.ElementBase;this.base(c);for(var a="",d=0;d<c.childNodes.length;d++)a+=c.childNodes[d].nodeValue;a=a.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,
"");a=b.compressSpaces(a);c=a.split("}");for(d=0;d<c.length;d++)if(""!=b.trim(c[d]))for(var k=c[d].split("{"),a=k[0].split(","),k=k[1].split(";"),e=0;e<a.length;e++){var f=b.trim(a[e]);if(""!=f){for(var g={},l=0;l<k.length;l++){var h=k[l].indexOf(":"),n=k[l].substr(0,h),h=k[l].substr(h+1,k[l].length-h);null!=n&&null!=h&&(g[b.trim(n)]=new b.Property(b.trim(n),b.trim(h)))}b.Styles[f]=g;if("@font-face"==f)for(f=g["font-family"].value.replace(/"/g,""),g=g.src.value.split(","),l=0;l<g.length;l++)if(0<
g[l].indexOf('format("svg")'))for(n=g[l].indexOf("url"),h=g[l].indexOf(")",n),n=g[l].substr(n+5,h-n-6),n=b.parseXml(b.ajax(n)).getElementsByTagName("font"),h=0;h<n.length;h++){var m=b.CreateElement(n[h]);b.Definitions[f]=m}}}};b.Element.style.prototype=new b.Element.ElementBase;b.Element.use=function(c){this.base=b.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),
0);this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))};this.getDefinition=function(){var a=this.getHrefAttribute().getDefinition();this.attribute("width").hasValue()&&(a.attribute("width",!0).value=this.attribute("width").value);this.attribute("height").hasValue()&&(a.attribute("height",!0).value=this.attribute("height").value);return a};this.path=function(a){var b=this.getDefinition();null!=b&&b.path(a)};this.getBoundingBox=function(){var a=this.getDefinition();if(null!=
a)return a.getBoundingBox()};this.renderChildren=function(a){var b=this.getDefinition();if(null!=b){var c=b.parent;b.parent=null;b.render(a);b.parent=c}}};b.Element.use.prototype=new b.Element.RenderedElementBase;b.Element.mask=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(a,c){var k=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==f&&0==g){g=new b.BoundingBox;
for(k=0;k<this.children.length;k++)g.addBoundingBox(this.children[k].getBoundingBox());k=Math.floor(g.x1);e=Math.floor(g.y1);f=Math.floor(g.width());g=Math.floor(g.height())}var h=c.attribute("mask").value;c.attribute("mask").value="";var p=document.createElement("canvas");p.width=k+f;p.height=e+g;var n=p.getContext("2d");this.renderChildren(n);var m=document.createElement("canvas");m.width=k+f;m.height=e+g;var q=m.getContext("2d");c.render(q);q.globalCompositeOperation="destination-in";q.fillStyle=
n.createPattern(p,"no-repeat");q.fillRect(0,0,k+f,e+g);a.fillStyle=q.createPattern(m,"no-repeat");a.fillRect(0,0,k+f,e+g);c.attribute("mask").value=h};this.render=function(a){}};b.Element.mask.prototype=new b.Element.ElementBase;b.Element.clipPath=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(a){for(var c=0;c<this.children.length;c++){var k=this.children[c];if("undefined"!=typeof k.path){var e=null;k.attribute("transform").hasValue()&&(e=new b.Transform(k.attribute("transform").value),
e.apply(a));k.path(a);a.clip();e&&e.unapply(a)}}};this.render=function(a){}};b.Element.clipPath.prototype=new b.Element.ElementBase;b.Element.filter=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(a,b){var c=b.getBoundingBox(),e=Math.floor(c.x1),f=Math.floor(c.y1),g=Math.floor(c.width()),c=Math.floor(c.height()),h=b.style("filter").value;b.style("filter").value="";for(var p=0,n=0,m=0;m<this.children.length;m++)var q=this.children[m].extraFilterDistance||0,p=Math.max(p,
q),n=Math.max(n,q);q=document.createElement("canvas");q.width=g+2*p;q.height=c+2*n;var s=q.getContext("2d");s.translate(-e+p,-f+n);b.render(s);for(m=0;m<this.children.length;m++)this.children[m].apply(s,0,0,g+2*p,c+2*n);a.drawImage(q,0,0,g+2*p,c+2*n,e-p,f-n,g+2*p,c+2*n);b.style("filter",!0).value=h};this.render=function(a){}};b.Element.filter.prototype=new b.Element.ElementBase;b.Element.feMorphology=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(a,b,c,e,f){}};b.Element.feMorphology.prototype=
new b.Element.ElementBase;b.Element.feColorMatrix=function(c){this.base=b.Element.ElementBase;this.base(c);this.apply=function(a,b,c,e,f){var g=a.getImageData(0,0,e,f);for(c=0;c<f;c++)for(b=0;b<e;b++){var h=(g.data[c*e*4+4*b+0]+g.data[c*e*4+4*b+1]+g.data[c*e*4+4*b+2])/3;g.data[c*e*4+4*b+0]=h;g.data[c*e*4+4*b+1]=h;g.data[c*e*4+4*b+2]=h}a.clearRect(0,0,e,f);a.putImageData(g,0,0)}};b.Element.feColorMatrix.prototype=new b.Element.ElementBase;b.Element.feGaussianBlur=function(c){this.base=b.Element.ElementBase;
this.base(c);this.extraFilterDistance=this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.apply=function(a,c,h,e,f){"undefined"==typeof stackBlurCanvasRGBA?"undefined"!=typeof console&&console.log("ERROR: StackBlur.js must be included for blur to work"):(a.canvas.id=b.UniqueId(),a.canvas.style.display="none",document.body.appendChild(a.canvas),stackBlurCanvasRGBA(a.canvas.id,c,h,e,f,this.blurRadius),document.body.removeChild(a.canvas))}};b.Element.feGaussianBlur.prototype=new b.Element.ElementBase;
b.Element.title=function(b){};b.Element.title.prototype=new b.Element.ElementBase;b.Element.desc=function(b){};b.Element.desc.prototype=new b.Element.ElementBase;b.Element.MISSING=function(b){"undefined"!=typeof console&&console.log("ERROR: Element '"+b.nodeName+"' not yet implemented.")};b.Element.MISSING.prototype=new b.Element.ElementBase;b.CreateElement=function(c){var a=c.nodeName.replace(/^[^:]+:/,""),a=a.replace(/\-/g,""),d=null,d="undefined"!=typeof b.Element[a]?new b.Element[a](c):new b.Element.MISSING(c);
d.type=c.nodeName;return d};b.load=function(c,a){b.loadXml(c,b.ajax(a))};b.loadXml=function(c,a){b.loadXmlDoc(c,b.parseXml(a))};b.loadXmlDoc=function(c,a){b.init(c);var d=function(a){for(var b=c.canvas;b;)a.x-=b.offsetLeft,a.y-=b.offsetTop,b=b.offsetParent;window.scrollX&&(a.x+=window.scrollX);window.scrollY&&(a.y+=window.scrollY);return a};!0!=b.opts.ignoreMouse&&(c.canvas.onclick=function(a){a=d(new b.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));b.Mouse.onclick(a.x,a.y)},
c.canvas.onmousemove=function(a){a=d(new b.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));b.Mouse.onmousemove(a.x,a.y)});var h=b.CreateElement(a.documentElement),e=h.root=!0,f=function(){b.ViewPort.Clear();c.canvas.parentNode&&b.ViewPort.SetCurrent(c.canvas.parentNode.clientWidth,c.canvas.parentNode.clientHeight);!0!=b.opts.ignoreDimensions&&(h.style("width").hasValue()&&(c.canvas.width=h.style("width").toPixels("x"),c.canvas.style.width=c.canvas.width+"px"),h.style("height").hasValue()&&
(c.canvas.height=h.style("height").toPixels("y"),c.canvas.style.height=c.canvas.height+"px"));var d=c.canvas.clientWidth||c.canvas.width,f=c.canvas.clientHeight||c.canvas.height;!0==b.opts.ignoreDimensions&&h.style("width").hasValue()&&h.style("height").hasValue()&&(d=h.style("width").toPixels("x"),f=h.style("height").toPixels("y"));b.ViewPort.SetCurrent(d,f);null!=b.opts.offsetX&&(h.attribute("x",!0).value=b.opts.offsetX);null!=b.opts.offsetY&&(h.attribute("y",!0).value=b.opts.offsetY);if(null!=
b.opts.scaleWidth&&null!=b.opts.scaleHeight){var g=1,m=1,q=b.ToNumberArray(h.attribute("viewBox").value);h.attribute("width").hasValue()?g=h.attribute("width").toPixels("x")/b.opts.scaleWidth:isNaN(q[2])||(g=q[2]/b.opts.scaleWidth);h.attribute("height").hasValue()?m=h.attribute("height").toPixels("y")/b.opts.scaleHeight:isNaN(q[3])||(m=q[3]/b.opts.scaleHeight);h.attribute("width",!0).value=b.opts.scaleWidth;h.attribute("height",!0).value=b.opts.scaleHeight;h.attribute("viewBox",!0).value="0 0 "+d*
g+" "+f*m;h.attribute("preserveAspectRatio",!0).value="none"}!0!=b.opts.ignoreClear&&c.clearRect(0,0,d,f);h.render(c);e&&(e=!1,"function"==typeof b.opts.renderCallback&&b.opts.renderCallback(a))},g=!0;b.ImagesLoaded()&&(g=!1,f());b.intervalID=setInterval(function(){var a=!1;g&&b.ImagesLoaded()&&(g=!1,a=!0);!0!=b.opts.ignoreMouse&&(a|=b.Mouse.hasEvents());if(!0!=b.opts.ignoreAnimation)for(var c=0;c<b.Animations.length;c++)a|=b.Animations[c].update(1E3/b.FRAMERATE);"function"==typeof b.opts.forceRedraw&&
!0==b.opts.forceRedraw()&&(a=!0);a&&(f(),b.Mouse.runEvents())},1E3/b.FRAMERATE)};b.stop=function(){b.intervalID&&clearInterval(b.intervalID)};b.Mouse=new function(){this.events=[];this.hasEvents=function(){return 0!=this.events.length};this.onclick=function(b,a){this.events.push({type:"onclick",x:b,y:a,run:function(a){if(a.onclick)a.onclick()}})};this.onmousemove=function(b,a){this.events.push({type:"onmousemove",x:b,y:a,run:function(a){if(a.onmousemove)a.onmousemove()}})};this.eventElements=[];this.checkPath=
function(b,a){for(var d=0;d<this.events.length;d++){var h=this.events[d];a.isPointInPath&&a.isPointInPath(h.x,h.y)&&(this.eventElements[d]=b)}};this.checkBoundingBox=function(b,a){for(var d=0;d<this.events.length;d++){var h=this.events[d];a.isPointInBox(h.x,h.y)&&(this.eventElements[d]=b)}};this.runEvents=function(){b.ctx.canvas.style.cursor="";for(var c=0;c<this.events.length;c++)for(var a=this.events[c],d=this.eventElements[c];d;)a.run(d),d=d.parent;this.events=[];this.eventElements=[]}};return b}
this.canvg=function(b,c,a){if(null==b&&null==c&&null==a){c=document.getElementsByTagName("svg");for(var d=0;d<c.length;d++){b=c[d];a=document.createElement("canvas");a.width=b.clientWidth;a.height=b.clientHeight;b.parentNode.insertBefore(a,b);b.parentNode.removeChild(b);var k=document.createElement("div");k.appendChild(b);canvg(a,k.innerHTML)}}else{a=a||{};"string"==typeof b&&(b=document.getElementById(b));null!=b.svg&&b.svg.stop();d=h();if(1!=b.childNodes.length||"OBJECT"!=b.childNodes[0].nodeName)b.svg=
d;d.opts=a;b=b.getContext("2d");"undefined"!=typeof c.documentElement?d.loadXmlDoc(b,c):"<"==c.substr(0,1)?d.loadXml(b,c):d.load(b,c)}}})();"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(h,b,c,a,d){canvg(this.canvas,h,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:a,scaleHeight:d})});
if(AmCharts.isModern){var saveAs=saveAs||"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(h){var b=h.document,c=h.URL||h.webkitURL||h,a=b.createElementNS("http://www.w3.org/1999/xhtml","a"),d=!h.externalHost&&"download"in a,k=h.webkitRequestFileSystem,e=h.requestFileSystem||k||h.mozRequestFileSystem,f=function(a){(h.setImmediate||h.setTimeout)(function(){throw a;},0)},g=0,l=[],p=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=
a["on"+b[d]];if("function"===typeof e)try{e.call(a,c||a)}catch(g){f(g)}}},n=function(c,f){var m=this,n=c.type,u=!1,v,y,z=function(){var a=(h.URL||h.webkitURL||h).createObjectURL(c);l.push(a);return a},A=function(){p(m,["writestart","progress","write","writeend"])},w=function(){if(u||!v)v=z(c);y?y.location.href=v:window.open(v,"_blank");m.readyState=m.DONE;A()},x=function(a){return function(){if(m.readyState!==m.DONE)return a.apply(this,arguments)}},B={create:!0,exclusive:!1},C;m.readyState=m.INIT;
f||(f="download");if(d)v=z(c),b=h.document,a=b.createElementNS("http://www.w3.org/1999/xhtml","a"),a.href=v,a.download=f,n=b.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!1,h,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(n),m.readyState=m.DONE,A();else{h.chrome&&n&&"application/octet-stream"!==n&&(C=c.slice||c.webkitSlice,c=C.call(c,0,c.size,"application/octet-stream"),u=!0);k&&"download"!==f&&(f+=".download");if("application/octet-stream"===n||k)y=h;e?(g+=c.size,e(h.TEMPORARY,g,x(function(a){a.root.getDirectory("saved",
B,x(function(a){var b=function(){a.getFile(f,B,x(function(a){a.createWriter(x(function(b){b.onwriteend=function(b){y.location.href=a.toURL();l.push(a);m.readyState=m.DONE;p(m,"writeend",b)};b.onerror=function(){var a=b.error;a.code!==a.ABORT_ERR&&w()};["writestart","progress","write","abort"].forEach(function(a){b["on"+a]=m["on"+a]});b.write(c);m.abort=function(){b.abort();m.readyState=m.DONE};m.readyState=m.WRITING}),w)}),w)};a.getFile(f,{create:!1},x(function(a){a.remove();b()}),x(function(a){a.code===
a.NOT_FOUND_ERR?b():w()}))}),w)}),w)):w()}},m=n.prototype;m.abort=function(){this.readyState=this.DONE;p(this,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;h.addEventListener("unload",function(){for(var a=l.length;a--;){var b=l[a];"string"===typeof b?c.revokeObjectURL(b):b.remove()}l.length=0},!1);return function(a,b){return new n(a,b)}}(this.self||this.window||this.content);"undefined"!==typeof module&&(module.exports=
saveAs)}
function RGBColor(h){this.ok=!1;"#"==h.charAt(0)&&(h=h.substr(1,6));h=h.replace(/ /g,"");h=h.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",
darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",
ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",
lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",
olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",
snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},c;for(c in b)h==c&&(h=b[c]);var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00",
"336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];for(c=0;c<a.length;c++){var d=a[c].process,k=a[c].re.exec(h);k&&(channels=d(k),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=0>this.r||isNaN(this.r)?0:255<this.r?255:this.r;this.g=0>this.g||isNaN(this.g)?0:255<this.g?255:this.g;
this.b=0>this.b||isNaN(this.b)?0:255<this.b?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);1==a.length&&(a="0"+a);1==b.length&&(b="0"+b);1==c.length&&(c="0"+c);return"#"+a+b+c};this.getHelpXML=function(){for(var c=[],d=0;d<a.length;d++)for(var g=a[d].example,h=0;h<g.length;h++)c[c.length]=g[h];for(var k in b)c[c.length]=k;g=document.createElement("ul");g.setAttribute("id",
"rgbcolor-examples");for(d=0;d<c.length;d++)try{var n=document.createElement("li"),m=new RGBColor(c[d]),q=document.createElement("div");q.style.cssText="margin: 3px; border: 1px solid black; background:"+m.toHex()+"; color:"+m.toHex();q.appendChild(document.createTextNode("test"));var s=document.createTextNode(" "+c[d]+" -> "+m.toRGB()+" -> "+m.toHex());n.appendChild(q);n.appendChild(s);g.appendChild(n)}catch(r){}return g}};