<div class="detailedView">
    <div id="detailedheader" class="navbar-inverse navbar" ng-if="interfaceManager.isSpectraActive()">
        <p><em>ID</em> {{interfaceManager.getActiveSpectra().id}} <em>NAME</em> {{interfaceManager.getActiveSpectra().name}}<em>RA</em> {{interfaceManager.getActiveSpectra().ra.toFixed(6)}} <em>DEC</em> {{interfaceManager.getActiveSpectra().dec.toFixed(6)}} <em>MAGNITUDE</em> {{interfaceManager.getActiveSpectra().magnitude.toFixed(2)}} <em>TYPE</em> {{interfaceManager.getActiveSpectra().type}}</p>
    </div>
    <div id="big" style="z-index: 999;"><canvas id="detailedCanvas" style="height: 100%; width: 100%"></canvas></div>
    {{interfaceManager.renderDetailedInitial()}}
</div>
<div id="detailedControl" ng-if="interfaceManager.menuActive=='Detailed'" class="row" style="margin-right: 0;">
    <div class="col-md-7">
        <div>
            <b>Save this redshift with a QOP of:</b>
            <div class="btn-group btn-group-justified">
                <div class="btn-group">
                    <button class="btn btn-sm btn-danger" ng-click="$parent.interfaceManager.saveManual(1)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Illegible (1)</button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-sm btn-warning" ng-click="$parent.interfaceManager.saveManual(2)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Poor (2)</button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-sm btn-info" ng-click="$parent.interfaceManager.saveManual(3)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Good (3)</button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-sm btn-success" ng-click="$parent.interfaceManager.saveManual(4)" tooltip="Saved!"  tooltip-trigger="focus" tooltip-placement="bottom">Great (4)</button>
                </div>
            </div>
        </div>
        <div class="topspace">
            <b>Template Options:</b>
            <div class="detailedInput">
                <label>Template:</label>
                <select style="width: 250px" ng-init="$parent.interfaceManager.detailedViewTemplate = $parent.interfaceManager.getInitialTemplate()" ng-change="$parent.changedTemplate()" ng-model="$parent.interfaceManager.detailedViewTemplate" data-ng-options="t.index as t.id + ' - ' + t.name for t in $parent.templateManager.getTemplatesAsJson()"></select>
            </div>
            <div class="detailedInput">
                <div style="float: left; width:140px">
                    <label>Scale: </label>
                    <input style="width: 55px" type="text" ng-model="$parent.interfaceManager.detailedSettings.templateScale">
                 </div>
                <div  style="margin-left: 140px">
                    <input type="range" min="{{$parent.interfaceManager.detailedSettings.minScale}}" max="{{$parent.interfaceManager.detailedSettings.maxScale}}"  step="0.01" ng-change="$parent.interfaceManager.detailedSettings.setTemplateScale()" ng-model="$parent.interfaceManager.detailedSettings.templateScale">
                </div>
                <div class="clear"></div>
            </div>
            <div class="detailedInput">
                <div style="float: left; width:140px">
                    <label>Offset: </label>
                    <input style="width: 55px" type="text"  ng-model="$parent.interfaceManager.detailedSettings.templatePixelOffset">
                </div>
                <div  style="margin-left: 140px">
                    <input type="range" min="{{-$parent.interfaceManager.detailedSettings.maxTemplatePixelOffset}}" max="{{$parent.interfaceManager.detailedSettings.maxTemplatePixelOffset}}"  step="1" ng-change="$parent.interfaceManager.detailedSettings.setTemplateOffset()" ng-model="$parent.interfaceManager.detailedSettings.templatePixelOffset">
                </div>
                <div class="clear"></div>
            </div>
            <div class="detailedInput">
                <div style="float: left; width:140px">
                    <label>Redshift: </label>
                    <input style="width: 55px" id="redshiftInput" type="text" ng-change="$parent.changedTemplate()" ng-model="$parent.interfaceManager.detailedViewZ">
                </div>
                <div  style="margin-left: 140px">
                    <input type="range" min={{$parent.interfaceManager.getMinRedshiftForDetailedTemplate()}} max="{{$parent.interfaceManager.detailedViewZMax}}" step="0.0001" ng-change="$parent.interfaceManager.changedRedshift()" ng-model="$parent.interfaceManager.detailedViewZ">
                </div>
                <div class="clear"></div>
            </div>
            <div class="detailedInput">
                <div class="btn-group "><!--btn-group-justified-->
                    <!--<div class="btn-group">-->
                        <button class="btn btn-sm btn-default" ng-model="interfaceManager.templateHasContinuum" btn-radio="false">No continuum</button>
                    <!--</div>-->
                    <!--<div class="btn-group">-->
                        <button class="btn btn-sm btn-default" ng-model="interfaceManager.templateHasContinuum" btn-radio="true">Continuum</button>
                    <!--</div>-->
                </div>
                <div class="btn-group pull-right">
                    <button class="btn btn-sm btn-primary" ng-click="interfaceManager.resetToAutomatic()">Reset to best auto</button>
                    <button class="btn btn-sm btn-primary" ng-click="interfaceManager.resetToManual()">Reset manual</button>
                </div>
            </div>
            <div class="clear"></div>
       </div>
        <div class="topspace" ng-if="interfaceManager.isSpectraActive()">
            <b>Top Automatic Results</b>
            <div ng-if="interfaceManager.hasMatchingDetails()">
                <p>Cycle through the best matches across all templates.</p>
                <!--<div class="detailedInput">
                    <div style="float: left; width:255px">
                        <label style="width: 190px">Compare Automatic Results:</label>
                        <input style="width: 25px; height: 25px; vertical-align: middle;" type="checkbox" ng-change="$parent.interfaceManager.matchingToggled()" ng-model="$parent.interfaceManager.matchedComparisonActive">
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="detailedInput">
                    <div style="float: left; width:255px">
                        <label style="width: 190px">Automatic Result Number:</label>
                        <input style="width: 45px" min="1" max="{{$parent.interfaceManager.maxMatchedIndex}}" type="number" ng-change="$parent.interfaceManager.matchedIndexChanged()" ng-model="$parent.interfaceManager.matchedIndex">
                    </div>
                    <div  style="margin-left: 255px">
                        <input type="range" min="1" max="{{$parent.interfaceManager.maxMatchedIndex}}" step="1" ng-change="$parent.interfaceManager.matchedIndexChanged()" ng-model="$parent.interfaceManager.matchedIndex">
                    </div>
                    <div class="clear"></div>
                </div>-->
                <div class="btn-group pull-left">
                    <button class="btn btn-sm btn-default" btn-radio="$index" ng-change="interfaceManager.matchedIndexChanged()" ng-model="interfaceManager.matchedIndex" ng-repeat="i in range(interfaceManager.maxMatchedIndex) track by $index">{{$index + 1}}</button>
                </div>
                <p ng-show="interfaceManager.matchedActive()" class="pull-left" style="margin-left: 10px; line-height: 30px;"><strong>{{interfaceManager.getMatchedTemplateName()}}</strong> at z = <strong>{{interfaceManager.getMatchedTemplateRedshift()}}</strong></p>
                <div class="clearfix"></div>
            </div>
            <div ng-if="!interfaceManager.hasMatchingDetails()">
                <p>No results list found. Expected if not analysed, or loaded from save.</p>
                <button class="btn btn-small btn-primary" ng-click="interfaceManager.reanalyseSpectra()">Click here to reanalyse and get full results</button>
            </div>
        </div>
    </div>
    <div class="col-md-5">
        <div>
            <b>Data Smoothing</b>
            <div class="detailedInput">
                <div style="float: left; width:105px">
                    <label style="width: 75px">Raw:</label>
                    <input style="width: 25px" type="text" ng-change="$parent.interfaceManager.changeRawSmooth()" ng-model="$parent.interfaceManager.detailViewRawSmooth">
                </div>
                <div  style="margin-left: 105px">
                    <input type="range" min="0" max="{{$parent.interfaceManager.detailViewSmoothMax}}"  step="1" ng-change="$parent.interfaceManager.changeRawSmooth()" ng-model="$parent.interfaceManager.detailViewRawSmooth">
                </div>
                <div class="clear"></div>
            </div>
            <div class="detailedInput">
                <div style="float: left; width:105px">
                    <label style="width: 75px">Processed:</label>
                    <input style="width: 25px" type="text" ng-change="$parent.interfaceManager.changeProcessedSmooth()" ng-model="$parent.interfaceManager.detailViewProcessedSmooth">
                </div>
                <div  style="margin-left: 105px">
                    <input type="range" min="0" max="{{$parent.interfaceManager.detailViewSmoothMax}}"  step="1" ng-change="$parent.interfaceManager.changeProcessedSmooth()" ng-model="$parent.interfaceManager.detailViewProcessedSmooth">
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div>
            <b>Spectral Lines</b>
            <ul class="list-unstyled" ng-class="{glowing:interfaceManager.detailedSettings.getWaiting()}">
                <li class="sline lined"  ng-click="$parent.interfaceManager.clickSpectralLine(i.id)" ng-class="{enabled:i.enabled}" ng-repeat="i in spectalLines.getAll() track by i.id">
                    {{i.label}}
                </li>
            </ul>
            <div class="clear"></div>
            <button class="btn btn-primary"  style="display: block; width: 200px; margin: 0 auto;" ng-click="$parent.interfaceManager.detailedSettings.toggleSpectralLines()">{{getSpectralLinePhrase()}}</button>
        </div>
    </div>
</div>